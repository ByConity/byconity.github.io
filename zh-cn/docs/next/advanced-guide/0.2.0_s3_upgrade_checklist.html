<!doctype html>
<html lang="zh-cn" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-advanced-guide/0.2.0_s3_upgrade_checklist">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Byconity 0.2.0 s3 storage upgrade checklist | ByConity</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://byconity.github.io/zh-cn/img/byconity-social-card.png"><meta data-rh="true" name="twitter:image" content="https://byconity.github.io/zh-cn/img/byconity-social-card.png"><meta data-rh="true" property="og:url" content="https://byconity.github.io/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Byconity 0.2.0 s3 storage upgrade checklist | ByConity"><meta data-rh="true" name="description" content="There are some s3 object key and s3 metadata changes after s3&#x27;s preview version(from pre 0.2.0 version to 0.2.0 version). And we provide some tools to migrate from old version. Only use this if you are using old version of byconity and store data in s3."><meta data-rh="true" property="og:description" content="There are some s3 object key and s3 metadata changes after s3&#x27;s preview version(from pre 0.2.0 version to 0.2.0 version). And we provide some tools to migrate from old version. Only use this if you are using old version of byconity and store data in s3."><link data-rh="true" rel="icon" href="/zh-cn/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://byconity.github.io/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist"><link data-rh="true" rel="alternate" href="https://byconity.github.io/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist" hreflang="en"><link data-rh="true" rel="alternate" href="https://byconity.github.io/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://byconity.github.io/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://Y8UJSN6KEB-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/zh-cn/blog/rss.xml" title="ByConity RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-cn/blog/atom.xml" title="ByConity Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BYY7CCPJZ6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BYY7CCPJZ6",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="ByConity" href="/zh-cn/opensearch.xml"><link rel="stylesheet" href="/zh-cn/assets/css/styles.d2f68745.css">
<link rel="preload" href="/zh-cn/assets/js/runtime~main.1d1e7260.js" as="script">
<link rel="preload" href="/zh-cn/assets/js/main.add246ce.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a class="skipToContent_Rzz1" href="#docusaurus_skipToContent_fallback">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav aria-label="ä¸»å¯¼èˆª" class="navbar navbar--fixed-top navbarHideable_hfek"><div class="navbar__inner"><div class="navbar__items"><button aria-label="åˆ‡æ¢å¯¼èˆªæ " aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-cn/"><div class="navbar__logo"><img src="/zh-cn/img/logo.png" alt="ByConity Logo" class="themedImage_DeRy themedImage--light_hbln"><img src="/zh-cn/img/logo.png" alt="ByConity Logo" class="themedImage_DeRy themedImage--dark_qgR1"></div><b class="navbar__title text--truncate">ByConity</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-cn/docs/next/introduction/main-principle-concepts">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/zh-cn/blog">åšå®¢</a><a class="navbar__item navbar__link" href="/zh-cn/community">ç¤¾åŒº</a><a class="navbar__item navbar__link" href="/zh-cn/users">ç”¨æˆ·</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/zh-cn/docs/next/introduction/main-principle-concepts">0.3.0 ğŸš§</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist">0.3.0 ğŸš§</a></li><li><a class="dropdown__link" href="/zh-cn/docs/advanced-guide/0.2.0_s3_upgrade_checklist">0.2.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰</a><ul class="dropdown__menu"><li><a href="/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-cn">ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰</a></li></ul></div><a href="https://github.com/ByConity/ByConity" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"><span>GitHub</span></a><div class="searchBox_mmj0"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_NWrx docsWrapper_oNqO"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_LsNq" type="button"></button><div class="docPage_fHU4"><aside class="theme-doc-sidebar-container docSidebarContainer_jEGB"><div class="sidebarViewport_Gc0S"><div class="sidebar_uCr1 sidebarWithHideableNavbar_P_fD"><a tabindex="-1" class="sidebarLogo_XXeG" href="/zh-cn/"><img src="/zh-cn/img/logo.png" alt="ByConity Logo" class="themedImage_DeRy themedImage--light_hbln"><img src="/zh-cn/img/logo.png" alt="ByConity Logo" class="themedImage_DeRy themedImage--dark_qgR1"><b>ByConity</b></a><nav aria-label="æ–‡æ¡£ä¾§è¾¹æ " class="menu thin-scrollbar menu_s63m"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/introduction/main-principle-concepts">ByConityç®€ä»‹</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/quick-start/basic-database-operations">å¿«é€Ÿä¸Šæ‰‹</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/sql-syntax/ansi-compatibility">SQLè¯­æ³•è¯´æ˜</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/basic-guide/background-task-management">åŸºç¡€ä½¿ç”¨æ‰‹å†Œ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist">é«˜çº§ç”¨æˆ·æ‰‹å†Œ</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-cn/docs/next/advanced-guide/0.2.0_s3_upgrade_checklist">Byconity 0.2.0 s3 storage upgrade checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/background-task-configuration">é…ç½®åå°ä»»åŠ¡</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/bucket-table-best-practice">Bucket table æœ€ä½³å®è·µæ‰‹å†Œ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/column-based-storage">åˆ—å­˜è®¾è®¡åŸç†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/complex-query-model-and-optimisation">å¤æ‚æŸ¥è¯¢æ¨¡å‹å’Œæ‰§è¡Œè°ƒä¼˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/import-optimisation">å¯¼å…¥è°ƒä¼˜</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/ingest-column">Column ingestion query</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/managing-concurrency">äº‹åŠ¡å’Œå¹¶å‘æ§åˆ¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/query-acceleration">æŸ¥è¯¢åŠ é€Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/query-optimiser">æŸ¥è¯¢ä¼˜åŒ–å™¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/rbac">Role-based Access Control (RBAC)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-cn/docs/next/advanced-guide/resource-manager">èµ„æºç®¡ç†å™¨</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/community/become-maintainer">å‚ä¸ç¤¾åŒº</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/deployment/deployment-requirements">éƒ¨ç½²</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/zh-cn/docs/next/benchmarks/2023-09-13-byconity-tpcds-benchmark-olap/2023-09-13-byconity-vs-other-olap-engines-tpc-ds-benchmarks">æ€§èƒ½æµ‹è¯•</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_b8RI"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_QMJw"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>æ­¤ä¸º <!-- -->ByConity<!-- --> <b>0.3.0 ğŸš§</b> ç‰ˆå°šæœªå‘è¡Œçš„æ–‡æ¡£ã€‚</div><div class="margin-top--md">æœ€æ–°çš„æ–‡æ¡£è¯·å‚é˜… <b><a href="/zh-cn/docs/advanced-guide/0.2.0_s3_upgrade_checklist">æœ€æ–°ç‰ˆæœ¬</a></b> (<!-- -->0.2.0<!-- -->)ã€‚</div></div><div class="docItemContainer_EkDS"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_dvLu" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/zh-cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_ObZR"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">é«˜çº§ç”¨æˆ·æ‰‹å†Œ</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Byconity 0.2.0 s3 storage upgrade checklist</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">ç‰ˆæœ¬ï¼š0.3.0 ğŸš§</span><div class="tocCollapsible_Iw4v theme-doc-toc-mobile tocMobile_L4iJ"><button type="button" class="clean-btn tocCollapsibleButton_Omde">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><h1>Background</h1><p>There are some s3 object key and s3 metadata changes after s3&#x27;s preview version(from pre 0.2.0 version to 0.2.0 version). And we provide some tools to migrate from old version. Only use this if you are using old version of byconity and store data in s3.</p><p>There are <strong>4 steps</strong> in total. </p><h1>Usage</h1><h2 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="1-stop-bycontiy-cluster">1. Stop bycontiy cluster<a href="#1-stop-bycontiy-cluster" class="hash-link" aria-label="1. Stop bycontiy clusterçš„ç›´æ¥é“¾æ¥" title="1. Stop bycontiy clusterçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>stop the cluster.</p><h2 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="2-migrate-s3-data-with-provided-tool">2. Migrate s3 data with provided tool<a href="#2-migrate-s3-data-with-provided-tool" class="hash-link" aria-label="2. Migrate s3 data with provided toolçš„ç›´æ¥é“¾æ¥" title="2. Migrate s3 data with provided toolçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="if-you-know-where-the-clickhouse-binary-isif-you-are-running-byconity-with-docker-you-can-find-it-by-login-into-serverworker-pod-and-using-ps-command-to-find-the-clickhouse-binary-path">If you know where the clickhouse binary is(If you are running byconity with docker you can find it by login into server/worker pod and using ps command to find the clickhouse binary path)<a href="#if-you-know-where-the-clickhouse-binary-isif-you-are-running-byconity-with-docker-you-can-find-it-by-login-into-serverworker-pod-and-using-ps-command-to-find-the-clickhouse-binary-path" class="hash-link" aria-label="If you know where the clickhouse binary is(If you are running byconity with docker you can find it by login into server/worker pod and using ps command to find the clickhouse binary path)çš„ç›´æ¥é“¾æ¥" title="If you know where the clickhouse binary is(If you are running byconity with docker you can find it by login into server/worker pod and using ps command to find the clickhouse binary path)çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-shell codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-shell codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token plain">./clickhouse s3-rename --s3_ak_id </span><span class="token variable" style="color:#36acaa">${S3_AK_ID}</span><span class="token plain"> --s3_ak_secret </span><span class="token variable" style="color:#36acaa">${S3_AK_SECRET}</span><span class="token plain"> --from_bucket </span><span class="token variable" style="color:#36acaa">${BYCONITY_S3_BUCKET}</span><span class="token plain"> --s3_endpoint </span><span class="token variable" style="color:#36acaa">${S3_ENDPOINT}</span><span class="token plain"> --s3_region </span><span class="token variable" style="color:#36acaa">${S3_REGION}</span><span class="token plain"> --root_prefix </span><span class="token variable" style="color:#36acaa">${BYCONTIY_DATA_PREFIX}</span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="or-if-you-are-running-byconity-with-docker-wrapper">Or if you are running byconity with docker wrapper<a href="#or-if-you-are-running-byconity-with-docker-wrapper" class="hash-link" aria-label="Or if you are running byconity with docker wrapperçš„ç›´æ¥é“¾æ¥" title="Or if you are running byconity with docker wrapperçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-shell codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-shell codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -it --rm --network </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> --name byconity-s3-sanitizer byconity/byconity:0.2.0 clickhouse s3-rename --s3_ak_id </span><span class="token variable" style="color:#36acaa">${S3_AK_ID}</span><span class="token plain"> --s3_ak_secret </span><span class="token variable" style="color:#36acaa">${S3_AK_SECRET}</span><span class="token plain"> --from_bucket </span><span class="token variable" style="color:#36acaa">${BYCONITY_S3_BUCKET}</span><span class="token plain"> --s3_endpoint </span><span class="token variable" style="color:#36acaa">${S3_ENDPOINT}</span><span class="token plain"> --s3_region </span><span class="token variable" style="color:#36acaa">${S3_REGION}</span><span class="token plain"> --root_prefix </span><span class="token variable" style="color:#36acaa">${BYCONTIY_DATA_PREFIX}</span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>tool arguments</th><th>explanation</th></tr></thead><tbody><tr><td>s3_ak_id</td><td>s3 access key id which byconity is using</td></tr><tr><td>s3_ak_secret</td><td>s3 secret access key which byconity is using</td></tr><tr><td>s3_region</td><td>s3 region which byconity is using</td></tr><tr><td>s3_endpoin</td><td>s3 endpoint which byconity is using</td></tr><tr><td>from_bucket</td><td>s3 bucket name which byconity is using</td></tr><tr><td>root_prefix</td><td>s3 object prefix which byconity is using</td></tr><tr><td>thread_number</td><td>using how many threads, default to 1 thread</td></tr><tr><td>need_delete</td><td>whether delete origin file, default true</td></tr><tr><td>uuid_check</td><td>whether check uuid is valid or not, default true</td></tr><tr><td>enable_logging</td><td>whether enable logging output</td></tr><tr><td>logging_level</td><td>logging level, default is debug output</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="3-migrate-s3-metadata-with-provided-tool">3. Migrate s3 metadata with provided tool<a href="#3-migrate-s3-metadata-with-provided-tool" class="hash-link" aria-label="3. Migrate s3 metadata with provided toolçš„ç›´æ¥é“¾æ¥" title="3. Migrate s3 metadata with provided toolçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="if-you-know-where-the-clickhouse-binary-is">If you know where the clickhouse binary is<a href="#if-you-know-where-the-clickhouse-binary-is" class="hash-link" aria-label="If you know where the clickhouse binary isçš„ç›´æ¥é“¾æ¥" title="If you know where the clickhouse binary isçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>./clickhouse s3-meta-sanitizer -C cnch_config.xml</p><h3 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="if-you-are-running-byconity-with-docker-wrapper">If you are running byconity with docker wrapper<a href="#if-you-are-running-byconity-with-docker-wrapper" class="hash-link" aria-label="If you are running byconity with docker wrapperçš„ç›´æ¥é“¾æ¥" title="If you are running byconity with docker wrapperçš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="language-shell codeBlockContainer_Dtwu theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sgmo"><pre tabindex="0" class="prism-code language-shell codeBlock_zjcW thin-scrollbar"><code class="codeBlockLines_u4eB"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run -it --rm --network </span><span class="token function" style="color:#d73a49">host</span><span class="token plain"> --name byconity-s3-sanitizer byconity/byconity:0.2.0 clickhouse s3-meta-sanitizer --config-file /root/app/config/cnch_config.xml</span><br></span></code></pre><div class="buttonGroup_uzaf"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_MWsZ" aria-hidden="true"><svg class="copyButtonIcon_utg0" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_YlgY" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><table><thead><tr><th>tool arguments</th><th>explanation</th></tr></thead><tbody><tr><td>C</td><td>specify config file from <code>cnch_config</code> configuration field in your bycontiy server configuration file</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_l3HI" id="4-start-byconity-cluster">4. Start byconity cluster<a href="#4-start-byconity-cluster" class="hash-link" aria-label="4. Start byconity clusterçš„ç›´æ¥é“¾æ¥" title="4. Start byconity clusterçš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>start the cluster.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>æ ‡ç­¾ï¼š</b><ul class="tags_HAaO padding--none margin-left--sm"><li class="tag_Ut5_"><a class="tag_sQub tagRegular_dfhI" href="/zh-cn/docs/next/tags/docs">Docs</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ByConity/byconity.github.io/tree/main/docs/advanced-guide/0.2.0_s3_upgrade_checklist.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_O9Og" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç¼–è¾‘æ­¤é¡µ</a></div><div class="col lastUpdated_DEFe"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-cn/docs/next/basic-guide/virtual-warehouse-configuration"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">é…ç½®è®¡ç®—ç»„</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-cn/docs/next/advanced-guide/background-task-configuration"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">é…ç½®åå°ä»»åŠ¡</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_Q7NC thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-stop-bycontiy-cluster" class="table-of-contents__link toc-highlight">1. Stop bycontiy cluster</a></li><li><a href="#2-migrate-s3-data-with-provided-tool" class="table-of-contents__link toc-highlight">2. Migrate s3 data with provided tool</a><ul><li><a href="#if-you-know-where-the-clickhouse-binary-isif-you-are-running-byconity-with-docker-you-can-find-it-by-login-into-serverworker-pod-and-using-ps-command-to-find-the-clickhouse-binary-path" class="table-of-contents__link toc-highlight">If you know where the clickhouse binary is(If you are running byconity with docker you can find it by login into server/worker pod and using ps command to find the clickhouse binary path)</a></li><li><a href="#or-if-you-are-running-byconity-with-docker-wrapper" class="table-of-contents__link toc-highlight">Or if you are running byconity with docker wrapper</a></li></ul></li><li><a href="#3-migrate-s3-metadata-with-provided-tool" class="table-of-contents__link toc-highlight">3. Migrate s3 metadata with provided tool</a><ul><li><a href="#if-you-know-where-the-clickhouse-binary-is" class="table-of-contents__link toc-highlight">If you know where the clickhouse binary is</a></li><li><a href="#if-you-are-running-byconity-with-docker-wrapper" class="table-of-contents__link toc-highlight">If you are running byconity with docker wrapper</a></li></ul></li><li><a href="#4-start-byconity-cluster" class="table-of-contents__link toc-highlight">4. Start byconity cluster</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row"><div class="col col--3"><img src="/zh-cn/img/footer-logo.svg" alt="ByConity" class="themedImage_DeRy themedImage--light_hbln footer__logo"><img src="/zh-cn/img/footer-logo.svg" alt="ByConity" class="themedImage_DeRy themedImage--dark_qgR1 footer__logo"></div><div class="col"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">æ–‡æ¡£</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/docs/introduction/main-principle-concepts">æ–‡æ¡£</a></li></ul></div><div class="col footer__col"><div class="footer__title">ç¤¾åŒº</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/community">Community</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-cn/users">ç”¨æˆ·</a></li><li class="footer__item"><a href="https://space.bilibili.com/2065226922?spm_id_from=333.1007.0.0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bç«™<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LBPb"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">æ›´å¤š</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/blog">åšå®¢</a></li><li class="footer__item"><a href="https://github.com/ByConity/ByConity" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_LBPb"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 ByteDance.</div></div></div></footer></div>
<script src="/zh-cn/assets/js/runtime~main.1d1e7260.js"></script>
<script src="/zh-cn/assets/js/main.add246ce.js"></script>
</body>
</html>