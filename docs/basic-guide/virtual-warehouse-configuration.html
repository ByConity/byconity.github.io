<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-basic-guide/virtual-warehouse-configuration">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Virtual Warehouse Configuration | ByConity</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://byconity.github.io/img/byconity-social-card.png"><meta data-rh="true" name="twitter:image" content="https://byconity.github.io/img/byconity-social-card.png"><meta data-rh="true" property="og:url" content="https://byconity.github.io/docs/basic-guide/virtual-warehouse-configuration"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Virtual Warehouse Configuration | ByConity"><meta data-rh="true" name="description" content="Document Type: Tutorial"><meta data-rh="true" property="og:description" content="Document Type: Tutorial"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://byconity.github.io/docs/basic-guide/virtual-warehouse-configuration"><link data-rh="true" rel="alternate" href="https://byconity.github.io/docs/basic-guide/virtual-warehouse-configuration" hreflang="en"><link data-rh="true" rel="alternate" href="https://byconity.github.io/zh-cn/docs/basic-guide/virtual-warehouse-configuration" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://byconity.github.io/docs/basic-guide/virtual-warehouse-configuration" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ByConity RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ByConity Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ca3e33a6.css">
<link rel="preload" href="/assets/js/runtime~main.c77bd5e2.js" as="script">
<link rel="preload" href="/assets/js/main.1bb2396d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_dYNx" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_HwYA"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--light_CjtC"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--dark_quyK"></div><b class="navbar__title text--truncate">ByConity</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/main-principle-concepts">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/users">Users</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">English</a><ul class="dropdown__menu"><li><a href="/docs/basic-guide/virtual-warehouse-configuration" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-cn/docs/basic-guide/virtual-warehouse-configuration" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">中文（中国）</a></li></ul></div><a href="https://github.com/ByConity/ByConity" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"><span>GitHub</span></a><div class="searchBox_ldyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_MxCR docsWrapper_h_X8"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Kzpt" type="button"></button><div class="docPage_GWs5"><aside class="theme-doc-sidebar-container docSidebarContainer_ldoy"><div class="sidebarViewport_TwFD"><div class="sidebar_H_01 sidebarWithHideableNavbar_Ezn7"><a tabindex="-1" class="sidebarLogo_NiAm" href="/"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--light_CjtC"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--dark_quyK"><b>ByConity</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_J18w"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/introduction/main-principle-concepts">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/sql-syntax/ansi-compatibility">SQL Syntax</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/basic-guide/background-task-management">Basic Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/background-task-management">Background Tasks Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/client-connection">Client Connection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/cluster-configuration">Cluster Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-export">Export Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-import">Import Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-type">Data Type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-visualisation">Data Visualisation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/database-table-design">Database Table Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/deployment-requirements">Deployment Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/monitoring">Monitor Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/basic-guide/virtual-warehouse-configuration">Virtual Warehouse Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/advanced-guide/background-task-configuration">Advanced Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/community/community-code-of-conduct">Community</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_baW4"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Njrt"><div class="docItemContainer_ZzVP"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_HWXL" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_IT7R"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Basic Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Virtual Warehouse Configuration</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_GIgr theme-doc-toc-mobile tocMobile_JEhh"><button type="button" class="clean-btn tocCollapsibleButton_Q9up">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Virtual Warehouse Configuration</h1><p>Document Type: Tutorial</p><p>Document format: tutorial purpose, pre-preparation, step-by-step explanation of principles &amp; examples, and related document recommendations;</p><h1>Calculate the relationship between groups, Workers and Servers</h1><p>In the <!-- -->[Resource Manager]<!-- -->(../Advanced User Manual/Resource Manager) chapter, we introduced <strong>Virtual Warehouse</strong> (referred to as VW), <strong>Worker Group</strong> (referred to as WG) and Worker. In a ByConity cluster, computing resources are divided into multiple Virtual Warehouse, each Virtual Warehouse contains multiple Worker Groups with the same configuration, and each Worker Group contains multiple workers. Resources can be freely expanded and contracted at different levels to achieve elastic computing. Taking expansion as an example, we can have different expansion methods:</p><ul><li>Vertically expand the CPU and MEM resources of the Worker to improve the processing performance of a single node.</li><li>Increase the number of workers in a Worker Group to improve the performance of the Worker Group when processing queries.</li><li>Increase the number of Worker Group in the Virtual Warehouse to improve the concurrency capability of the Virtual Warehouse to process queries.</li><li>Add new Virtual Warehouse resources for new businesses or tenants to achieve resource isolation between tenants.</li></ul><p>The service node, which we also call server, mainly undertakes the functions of sql receiving, scheduling, and result return. Computing nodes, also called workers, are mainly responsible for computing tasks, which can be data writing, user query, or some background tasks. User queries and background tasks can share the same worker to improve utilization, or use independent workers to ensure strict resource isolation. Users can build multiple virtual_warehouses according to the characteristics, priorities, and business categories of computing tasks, and set different resource elasticity policies to improve computing efficiency and reduce costs.</p><h1>View Virtual Warehouse information</h1><p>We provide a set of system tables to query the metadata related to the Virtual Warehouse. These system tables only provide observable capabilities, and the Virtual Warehouse information cannot be changed by modifying the table content. If you need to modify the configuration of the Virtual Warehouse, please refer to <!-- -->[Modify the configuration of the Virtual Warehouse]<!-- --> (todo: link).</p><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="systemvirtual_warehouses">system.virtual_warehouses<a href="#systemvirtual_warehouses" class="hash-link" aria-label="Direct link to system.virtual_warehouses" title="Direct link to system.virtual_warehouses">​</a></h2><p>The system table shows the meta information, main fields and descriptions of all virtual warehouse (VW):</p><table><thead><tr><th align="left">Field name</th><th align="left">Descriptions</th></tr></thead><tbody><tr><td align="left">name</td><td align="left">The name of the virtual warehouse, unique identification.</td></tr><tr><td align="left"><strong>type</strong></td><td align="left">The type of the virtual warehouse, Default/Write.</td></tr><tr><td align="left"><strong>num_workers</strong></td><td align="left">The number of workers configured for each worker group by this virtual warehouse</td></tr><tr><td align="left">active_worker_groups</td><td align="left">The number of running worker groups in this virtual warehouse</td></tr><tr><td align="left">active_workers</td><td align="left">The number of healthy workers in this virtual warehouse</td></tr><tr><td align="left">min_worker_groups</td><td align="left">The minimum number of worker groups this virtual warehouse is allowed to run</td></tr><tr><td align="left">max_worker_groups</td><td align="left">The maximum number of worker groups that this virtual warehouse is allowed to run</td></tr><tr><td align="left">max_concurrent_queries</td><td align="left">The maximum number of concurrent queries allowed by the virtual warehouse</td></tr><tr><td align="left">max_queued_queries</td><td align="left">The maximum number of queued queries allowed by this virtual warehouse</td></tr><tr><td align="left">max_queued_waiting_ms</td><td align="left">The maximum waiting time for queued queries allowed by this virtual warehouse (milliseconds)</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="systemworker_groups">system.worker_groups<a href="#systemworker_groups" class="hash-link" aria-label="Direct link to system.worker_groups" title="Direct link to system.worker_groups">​</a></h2><p>This system table displays the meta information, main fields and descriptions of all worker groups (WG):：</p><table><thead><tr><th align="left">Field name</th><th align="left">Descriptions</th></tr></thead><tbody><tr><td align="left">vw_name</td><td align="left">The name of the virtual warehouse to which this worker group belongs</td></tr><tr><td align="left">id</td><td align="left">The id of the worker group, unique identification</td></tr><tr><td align="left">num_workers</td><td align="left">The number of workers configured for each worker group by this virtual warehouse</td></tr><tr><td align="left">linked_id</td><td align="left">If the worker group is a Shared type, linked_id points to the Physical worker group it refers to</td></tr><tr><td align="left">active_workers</td><td align="left">The number of active workers in this worker group</td></tr><tr><td align="left">min_cpu_usage</td><td align="left">The smallest worker cpu_usage in the worker group</td></tr><tr><td align="left">max_cpu_usage</td><td align="left">The maximum worker cpu_usage in the worker group</td></tr><tr><td align="left">avg_cpu_usage</td><td align="left">The average cpu_usage of all workers in this worker group</td></tr><tr><td align="left">min_mem_usage</td><td align="left">The smallest worker memory_usage in the worker group</td></tr><tr><td align="left">max_mem_usage</td><td align="left">The largest worker memory_usage in the worker group</td></tr><tr><td align="left">avg_mem_usage</td><td align="left">The average memory_usage of all workers in the worker group</td></tr></tbody></table><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="systemworkers">system.workers<a href="#systemworkers" class="hash-link" aria-label="Direct link to system.workers" title="Direct link to system.workers">​</a></h2><p>The system table records all running worker information, main fields and descriptions:</p><table><thead><tr><th align="left">Field name</th><th align="left">Descriptions</th></tr></thead><tbody><tr><td align="left">worker_id</td><td align="left">The id of the worker, unique identification</td></tr><tr><td align="left">vw_name</td><td align="left">The virtual warehouse the worker belongs to</td></tr><tr><td align="left">worker_group_id</td><td align="left">The worker group the worker belongs to</td></tr><tr><td align="left">host</td><td align="left">The host (ip)  of the worker</td></tr><tr><td align="left">tcp_port</td><td align="left">The tcp_port of the worker</td></tr><tr><td align="left">cpu_usage</td><td align="left">Current cpu_usage</td></tr><tr><td align="left">memory_usage</td><td align="left">Current memory_usage</td></tr><tr><td align="left">memory_available</td><td align="left">Current memory amount（byte） available</td></tr><tr><td align="left">last_update_time</td><td align="left">The latest heartbeat update time</td></tr></tbody></table><p>Create and use Virtual Warehouse</p><p>We provide two different configuration methods, local mode and cluster mode, to create Virtual Warehouse.</p><p>In local mode, you can directly fill in the Virtual Warehouse and worker group related information in the configuration file, which is convenient for debugging or demo operation.</p><p>Cluster mode is the recommended way to use it in a production environment. At this time, we need to create a Virtual Warehouse through specific SQL, and create actual Virtual Warehouse resources through corresponding K8s operations.</p><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="local-mode">local mode<a href="#local-mode" class="hash-link" aria-label="Direct link to local mode" title="Direct link to local mode">​</a></h2><p>When starting the resource manager component, we can fill in the Virtual Warehouse related information in the configuration file (refer to <a href="/docs/basic-guide/cluster-configuration">cluster-configuration</a> resource manager section). The resource manager will directly create corresponding  Virtual Warehouse (and worker group) based on these information. Example:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;vws&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;vw&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;name&gt;vw_default&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;type&gt;Default&lt;/type&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;num_workers&gt;1&lt;/num_workers&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;worker_groups&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;worker_group&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;name&gt;wg_default&lt;/name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;type&gt;Physical&lt;/type&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;/worker_group&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/worker_groups&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/vw&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/vws&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We have configured a Virtual Warehouse named vw_default, the type is Default, and it is expected that there will be 1 worker in this vw (num_workers is only used as an instruction to create a vw, the actual number of workers can be <u>query related system tables</u><u>(todo: link <!-- -->[view Virtual Warehouse information]</u><u>)</u> get). At the same time, we configured 1 replica for this Virtual Warehouse, named wg_default.</p><p>When starting the server component, we can directly configure the worker information corresponding to each vw in the service discovery part of the configuration file (refer to <a href="/docs/basic-guide/cluster-configuration">cluster configuration</a> server part).</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;service_discovery&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;mode&gt;local&lt;/mode&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;vw&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;psm&gt;data.cnch.vw_default&lt;/psm&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;node&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;vw_name&gt;vw_default&lt;/vw_name&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;host&gt;10.1.2.3&lt;/host&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;hostname&gt;vw_default0&lt;/hostname&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;ports&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;!-- TCP/Primary --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;port&gt;&lt;name&gt;PORT0&lt;/name&gt;&lt;value&gt;31067&lt;/value&gt;&lt;/port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;!-- RPC --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;port&gt;&lt;name&gt;PORT1&lt;/name&gt;&lt;value&gt;32099&lt;/value&gt;&lt;/port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;!-- HTTP --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;port&gt;&lt;name&gt;PORT2&lt;/name&gt;&lt;value&gt;35166&lt;/value&gt;&lt;/port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;!-- Exchange --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;port&gt;&lt;name&gt;PORT5&lt;/name&gt;&lt;value&gt;39481&lt;/value&gt;&lt;/port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;!-- Exchange status --&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;port&gt;&lt;name&gt;PORT6&lt;/name&gt;&lt;value&gt;39482&lt;/value&gt;&lt;/port&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;/ports&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/node&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/vw&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/service_discovery&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In this example, when the server does service discovery, it will find a worker whose ip is 10.1.2.3 in the virtual warehouse vw_default.</p><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="cluster-mode">cluster mode<a href="#cluster-mode" class="hash-link" aria-label="Direct link to cluster mode" title="Direct link to cluster mode">​</a></h2><p>We can create new Virtual Warehouse while the ByConity cluster is running.</p><h3 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="create-virtual-warehouse">Create Virtual Warehouse<a href="#create-virtual-warehouse" class="hash-link" aria-label="Direct link to Create Virtual Warehouse" title="Direct link to Create Virtual Warehouse">​</a></h3><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WAREHOUSE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IF NOT EXISTS `vw_default`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SETTINGS num_workers = 1, type = &#x27;Default&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         auto_suspend = 3600, auto_resume = 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         min_worker_groups = 0, max_worker_groups = 1, max_concurrent_queries=200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>CREATE WAREHOUSE IF NOT EXISTS </code>$VW_NAME<code> SETTINGS ...</code> This SQL is used to create computed groups. $VW_NAME is the unique identifier of the computing group. When creating a computing group, num_workers and type in the settings are required. For other configurations, please refer to the <!-- -->[View Virtual Warehouse Information]<!-- --> section.</p><h3 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="creat-worker-group">Creat Worker Group<a href="#creat-worker-group" class="hash-link" aria-label="Direct link to Creat Worker Group" title="Direct link to Creat Worker Group">​</a></h3><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE WORKER GROUP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IF NOT EXISTS `wg_default` in `vw_default`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SETTINGS type = &#x27;Physical&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>CREATE WORKER GROUP IF NOT EXISTS </code>$WG_NAME<code>SETTINGS ...</code>This SQL is used to create a worker group. $WG_NAME is the unique identifier of the worker group.</p><h3 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="creat-k8s-worker-pods">Creat K8s Worker Pods<a href="#creat-k8s-worker-pods" class="hash-link" aria-label="Direct link to Creat K8s Worker Pods" title="Direct link to Creat K8s Worker Pods">​</a></h3><p>After ByConity creates the meta information of the virtual warehouses and worker group, you can create the corresponding K8s Worker resource, and configure the corresponding environment variables VIRTUAL_WAREHOUSE_ID=$VW_NAME, WORKER_GROUP_ID=$WG_NAME for the worker.</p><p>After the Worker is started, it can be automatically registered in the corresponding virtual warehouse and worker group.</p><p>For specific operations, please check：<a href="https://github.com/ByConity/byconity-deploy" target="_blank" rel="noopener noreferrer">https://github.com/ByConity/byconity-deploy</a></p><h1>Modify Virtual Warehouses</h1><p>In addition to viewing and creating virtual warehouses information, we can also modify virtual warehouses related meta information at runtime.</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">DROP WAREHOUSE IF EXISTS `vw_default`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DROP WORKER GROUP IF EXISTS `wg_default`;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above DROP statement will delete the specified virtual warehouses and worker group.</p><p>Note: When the virtual warehouse specified by the worker pod cannot be found in the ByConity meta information, the resource manager will reject the registration of the worker, so the worker cannot be used to process queries.</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">ALTER WAREHOUSE `vw_default`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SETTINGS auto_suspend = 3600, auto_resume = 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          min_worker_groups = 0, max_worker_groups = 0, max_concurrent_queries=50;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The above ALTER statement can modify the configuration of the virtual warehouses. After modification, all worker groups in the virtual warehouses will use the new configuration.</p><p>Note: We cannot modify the configuration of the worker group through <code>ALTER WORKER GROUP ...</code>. All configurations of a worker group are inherited from the configuration of the owning virtual warehouses, so no such syntax exists.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags__Zuh padding--none margin-left--sm"><li class="tag_G1J1"><a class="tag_lVyf tagRegular_MP1R" href="/docs/tags/docs">Docs</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ByConity/byconity.github.io/tree/main/docs/basic-guide/virtual-warehouse-configuration.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_rssB" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_ZTIL"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/basic-guide/monitoring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Monitor Cluster</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/advanced-guide/background-task-configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Background Tasks Configuration</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_a4zv thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#systemvirtual_warehouses" class="table-of-contents__link toc-highlight">system.virtual_warehouses</a></li><li><a href="#systemworker_groups" class="table-of-contents__link toc-highlight">system.worker_groups</a></li><li><a href="#systemworkers" class="table-of-contents__link toc-highlight">system.workers</a></li><li><a href="#local-mode" class="table-of-contents__link toc-highlight">local mode</a></li><li><a href="#cluster-mode" class="table-of-contents__link toc-highlight">cluster mode</a><ul><li><a href="#create-virtual-warehouse" class="table-of-contents__link toc-highlight">Create Virtual Warehouse</a></li><li><a href="#creat-worker-group" class="table-of-contents__link toc-highlight">Creat Worker Group</a></li><li><a href="#creat-k8s-worker-pods" class="table-of-contents__link toc-highlight">Creat K8s Worker Pods</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row"><div class="col col--3"><img src="/img/footer-logo.svg" alt="ByConity" class="themedImage_rLhL themedImage--light_CjtC footer__logo"><img src="/img/footer-logo.svg" alt="ByConity" class="themedImage_rLhL themedImage--dark_quyK footer__logo"></div><div class="col"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/main-principle-concepts">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community">Community</a></li><li class="footer__item"><a class="footer__link-item" href="/users">Users</a></li><li class="footer__item"><a href="https://space.bilibili.com/2065226922?spm_id_from=333.1007.0.0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/ByConity/ByConity" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 ByteDance.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c77bd5e2.js"></script>
<script src="/assets/js/main.1bb2396d.js"></script>
</body>
</html>