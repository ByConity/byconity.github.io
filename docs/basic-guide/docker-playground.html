<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-basic-guide/docker-playground">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Docker Playground | ByConity</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://byconity.github.io/img/byconity-social-card.png"><meta data-rh="true" name="twitter:image" content="https://byconity.github.io/img/byconity-social-card.png"><meta data-rh="true" property="og:url" content="https://byconity.github.io/docs/basic-guide/docker-playground"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker Playground | ByConity"><meta data-rh="true" name="description" content="Prerequisite"><meta data-rh="true" property="og:description" content="Prerequisite"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://byconity.github.io/docs/basic-guide/docker-playground"><link data-rh="true" rel="alternate" href="https://byconity.github.io/docs/basic-guide/docker-playground" hreflang="en"><link data-rh="true" rel="alternate" href="https://byconity.github.io/zh-cn/docs/basic-guide/docker-playground" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://byconity.github.io/docs/basic-guide/docker-playground" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ByConity RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ByConity Atom Feed"><link rel="stylesheet" href="/assets/css/styles.ca3e33a6.css">
<link rel="preload" href="/assets/js/runtime~main.4c8af0de.js" as="script">
<link rel="preload" href="/assets/js/main.277df070.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_dYNx" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top navbarHideable_HwYA"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--light_CjtC"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--dark_quyK"></div><b class="navbar__title text--truncate">ByConity</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction/main-principle-concepts">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/community">Community</a><a class="navbar__item navbar__link" href="/users">Users</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">English</a><ul class="dropdown__menu"><li><a href="/docs/basic-guide/docker-playground" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><a href="/zh-cn/docs/basic-guide/docker-playground" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">中文（中国）</a></li></ul></div><a href="https://github.com/ByConity/ByConity" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"><span>GitHub</span></a><div class="searchBox_ldyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_MxCR docsWrapper_h_X8"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Kzpt" type="button"></button><div class="docPage_GWs5"><aside class="theme-doc-sidebar-container docSidebarContainer_ldoy"><div class="sidebarViewport_TwFD"><div class="sidebar_H_01 sidebarWithHideableNavbar_Ezn7"><a tabindex="-1" class="sidebarLogo_NiAm" href="/"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--light_CjtC"><img src="/img/logo.png" alt="ByConity Logo" class="themedImage_rLhL themedImage--dark_quyK"><b>ByConity</b></a><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_J18w"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/introduction/main-principle-concepts">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/sql-syntax/ansi-compatibility">SQL Syntax</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/basic-guide/background-task-management">Basic Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/background-task-management">Background Tasks Management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/client-connection">Client Connection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/cluster-configuration">Cluster Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-export">Export Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-import">Import Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-type">Data Type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/data-visualisation">Data Visualisation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/database-table-design">Database Table Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/deployment-requirements">Deployment Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/basic-guide/docker-playground">Docker Playground</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/monitoring">Monitor Cluster</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/basic-guide/virtual-warehouse-configuration">Virtual Warehouse Configuration</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/advanced-guide/background-task-configuration">Advanced Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/community/community-code-of-conduct">Community</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/deployment/deploy-k8s">Deployment</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_baW4"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Njrt"><div class="docItemContainer_ZzVP"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_HWXL" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_IT7R"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Basic Guides</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker Playground</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_GIgr theme-doc-toc-mobile tocMobile_JEhh"><button type="button" class="clean-btn tocCollapsibleButton_Q9up">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Docker Playground</h1><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="prerequisite">Prerequisite<a href="#prerequisite" class="hash-link" aria-label="Direct link to Prerequisite" title="Direct link to Prerequisite">​</a></h2><p>Before running, make sure your system has following prerequisite:</p><ul><li>docker</li><li>docker-compose</li><li>a docker runtime is up and running</li></ul><p><strong>Important notes:</strong> this repo has been thoroughly tested on: (1) MacOS Catalina (Intel Silicon), and (2) Debian 9. For other platforms, there&#x27;re some known issues:</p><ul><li>FoundationDB docker cannot start on Apple Silicon machines</li><li>FoundationDB docker cannot start on WSL</li></ul><p>If you&#x27;re using MacOS and cannot use docker desktop, you can:</p><ol><li>Install <code>docker</code> and <code>docker-compose</code> with <code>brew install docker docker-compose</code></li><li>Use <a href="https://github.com/abiosoft/colima" target="_blank" rel="noopener noreferrer">Colima</a> to create a docker runtime env</li></ol><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="cluster-architecture">Cluster architecture<a href="#cluster-architecture" class="hash-link" aria-label="Direct link to Cluster architecture" title="Direct link to Cluster architecture">​</a></h2><p>We are going to deploy a byconity cluster with following architecture:</p><p><img loading="lazy" alt="cluster" src="/assets/images/architect-4fffec4c97e9ff3868f01f3caa43df6f.png" width="1147" height="818" class="img_Ne1E"></p><p>Four byconity components are:</p><ul><li>server: manage databases and tables, interacting with client, coordinate workers to handle query</li><li>worker-write: handle write (INSERT)</li><li>worker-read: handle read (SELECT)</li><li>daemon-manager: manage the background jobs (merge, kafka, etc...)</li></ul><p>There could be more than one worker-write and worker-default, and they can be organized into a <strong>virtual warehouse</strong>. When a virtual warehouse have multiple worker-write, each write query will randomly select a worker to run. When a virtual warehouse have multiple worker-default, a select query will be parallelized among as much workers as possible.</p><p>In addition, there&#x27;re following components in the cluster:</p><ul><li>foudationdb: a transactional kv database, all metadata of databases and tables will be stored here</li><li>hdfs: include one namenode and one datanode, is the <em>primary</em> storage of all tables data</li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="bring-the-cluster-up">Bring the cluster up<a href="#bring-the-cluster-up" class="hash-link" aria-label="Direct link to Bring the cluster up" title="Direct link to Bring the cluster up">​</a></h2><p>Checkout the byconity-docker code base</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">git clone git@github.com:ByConity/byconity-docker.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd byconity-docker</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>From the current directory, run:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose up</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wait until all containers are ready. By default, docker exposes the tcp port at 9000 and http port at 8123. We can use following commands to check the readiness of byconity components: </p><div class="language-s codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-s codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain"># return 1 indicates that server is working properly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl &#x27;127.0.0.1:8123/?query=select%20count()%20from%20system.one&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># return 1 indicates that read worker is working properly and server can connect to it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl &#x27;127.0.0.1:8123/?query=select%20count()%20from%20cnch(`vw_default`,system,one)&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># return 1 indicates that write worker is working properly and server can connect to it</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl &#x27;127.0.0.1:8123/?query=select%20count()%20from%20cnch(`vw_write`,system,one)&#x27;</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="trying-some-basic-queries">Trying some basic queries<a href="#trying-some-basic-queries" class="hash-link" aria-label="Direct link to Trying some basic queries" title="Direct link to Trying some basic queries">​</a></h2><p>Internally, byconity read/write to hdfs with username <code>clickhouse</code> (and data is stored in <code>/user/clickhouse/</code>), which is not created by default when starting hadoop cluster. We can use following commands to create the user <code>clickhouse</code> on hdfs.</p><div class="language-s codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-s codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">./hdfs/create_users.sh</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can use public clickhouse client to connect to byconity. If you don&#x27;t have clickhouse on your system, you can quickly download it by:</p><p>On MacOS:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">curl -O &#x27;https://builds.clickhouse.com/master/macos/clickhouse&#x27; &amp;&amp; chmod a+x ./clickhouse</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On Linux:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">curl -O &#x27;https://builds.clickhouse.com/master/amd64/clickhouse&#x27; &amp;&amp; chmod a+x clickhouse</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then connect to server by:</p><div class="language-s codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-s codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">./clickhouse client</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can use following queries to create a database, create a table, insert some data to table, and query from it:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DATABASE</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">USE</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> events </span><span class="token punctuation" style="color:#393A34">(</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">id</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> UInt64</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">s</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ENGINE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> CnchMergeTree </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTO</span><span class="token plain"> events </span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> number</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">number</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> numbers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> events </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> id</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the system is working correctly, the select query should show a similar result as bellow:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> events</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> id </span><span class="token keyword" style="color:#00009f">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: b5c4bc8e</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b768</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">432</span><span class="token plain">c</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b24c</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain">aa98c5e512d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─id─┬─s─┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│  </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────┴───┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:#36acaa">0.015</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="a-quick-look-into-how-the-data-is-stored">A quick look into how the data is stored<a href="#a-quick-look-into-how-the-data-is-stored" class="hash-link" aria-label="Direct link to A quick look into how the data is stored" title="Direct link to A quick look into how the data is stored">​</a></h2><p>In byconity, the metadata is stored on FoundationDB, while the actual data is store on HDFS. Let&#x27;s take a look at both of them.</p><h3 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="metadata">Metadata<a href="#metadata" class="hash-link" aria-label="Direct link to Metadata" title="Direct link to Metadata">​</a></h3><p>The metadata includes databases, tables, partitions, and parts. Here we only focus on how we store a part in FoundationDB. While you can use <code>fdbcli</code> to directly retrieve the data, we provide a system table <code>system.cnch_parts</code> to help you quickly query the metadata of a table:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">┌─name─────────────────┬─type──────────────────────────────────────────────────────────────────────────────┬─flags─┬─default_type─┬─default_expression─┬─comment─┬─codec_expression─┬─ttl_expression─┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ database             │ String                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ table                │ String                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ table_uuid           │ UUID                                                                              │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ partition            │ String                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ name                 │ String                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ bytes_on_disk        │ UInt64                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ rows_count           │ UInt64                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ columns              │ String                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ marks_count          │ UInt64                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ index_granularity    │ Array(UInt64)                                                                     │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ commit_time          │ DateTime                                                                          │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ kv_commit_time       │ DateTime                                                                          │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ columns_commit_time  │ DateTime                                                                          │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ mutation_commit_time │ DateTime                                                                          │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ previous_version     │ UInt64                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ partition_id         │ String                                                                            │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ bucket_number        │ Int64                                                                             │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ outdated             │ UInt8                                                                             │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ visible              │ UInt8                                                                             │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ part_type            │ Enum8(&#x27;VisiblePart&#x27; = 1, &#x27;InvisiblePart&#x27; = 2, &#x27;DropRange&#x27; = 3, &#x27;DroppedPart&#x27; = 4) │       │              │                    │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ active               │ UInt8                                                                             │       │ ALIAS        │ visible            │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ bytes                │ UInt64                                                                            │       │ ALIAS        │ bytes_on_disk      │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ rows                 │ UInt64                                                                            │       │ ALIAS        │ rows_count         │         │                  │                │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────────────────┴───────────────────────────────────────────────────────────────────────────────────┴───────┴──────────────┴────────────────────┴─────────┴──────────────────┴────────────────┘</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s try to query all metadata of above example table:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bytes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    part_type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> system</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cnch_parts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">database</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;events&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: </span><span class="token number" style="color:#36acaa">58</span><span class="token plain">c9113e</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">866</span><span class="token plain">f</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">a9e</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">80</span><span class="token plain">ee</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2</span><span class="token plain">d3283b2e4a8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─name───────────────────────────────────────────────────────────┬─</span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain">─┬─bytes─┬─part_type───┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ all_438015441180033025_438015441180033025_0_438015441166663680 │   </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> │  </span><span class="token number" style="color:#36acaa">1012</span><span class="token plain"> │ VisiblePart │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└────────────────────────────────────────────────────────────────┴──────┴───────┴─────────────┘</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="remote-data">Remote data<a href="#remote-data" class="hash-link" aria-label="Direct link to Remote data" title="Direct link to Remote data">​</a></h3><p>You can open the hdfs at <code>localhost:9870</code> to see how the data is stored. Byconity store each data part as a single file name <code>data</code> and the path is <code>{disk_root}/{table_uuid}/{part_name}/</code>. In the above example, the data on hdfs is as follow:</p><p><img loading="lazy" alt="Table path on disk" src="/assets/images/hdfs_path-ad5e56aadd031738c2316c867df2e0a6.png" width="1602" height="558" class="img_Ne1E"></p><p>Each table will have an UUID, and the path on hdfs is <code>{disk_root}/{table_uuid}</code>. Inside the table path, each part is stored in a single file name<code>data</code> and the path is <code>{disk_root}/{table_uuid}/{part_name}/</code>.</p><p><img loading="lazy" alt="Data part file on disk" src="/assets/images/hdfs_file-a7917c9b64eea79bffac3ee18670cc43.png" width="1277" height="412" class="img_Ne1E"></p><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="ssb-benchmark">SSB benchmark<a href="#ssb-benchmark" class="hash-link" aria-label="Direct link to SSB benchmark" title="Direct link to SSB benchmark">​</a></h2><p>The minimum requirement to run SSB 1G is each container has 1CPU and 1GB RAM. If you&#x27;re using MacOS, you should config the Docker VM to have 2CPU and 8GB RAM.</p><p>SSB stand for <em>Star Schema Benchmark</em>. It contains four tables in a star-schema and one single flat table. The data is generated from a software. The total amount of data (a.k.a <em>scale</em>) can be chosen when generating. Scale 1 generates 6 million rows, while scale 1000 generates 6 billion rows. In this example, we use scale 1. To change the scale, you can change the generation command in the script.</p><p>To create the table and import data to it, from current directory run:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">./datasets/ssb_import.sh</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The script will create the table, generate the data, import it into byconity via clickhouse client, then create the flat table. When the importing done, you play with query in <code>datasets/ssb.sql</code></p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_REVENUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toYear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_ORDERDATE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">year</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P_BRAND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> lineorder_flat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">P_BRAND </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;MFGR#2239&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S_REGION </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;EUROPE&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">year</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P_BRAND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">year</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ASC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    P_BRAND </span><span class="token keyword" style="color:#00009f">ASC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: c8ed5cef</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">57</span><span class="token plain">dd</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">d0e</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">adf8</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ebea5d37d34e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌─</span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_REVENUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">─┬─</span><span class="token keyword" style="color:#00009f">year</span><span class="token plain">─┬─P_BRAND───┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">732065331</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1992</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">665355617</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1993</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">733858503</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1994</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">622904542</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1995</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">628615052</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1996</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">784212754</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1997</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       </span><span class="token number" style="color:#36acaa">409670997</span><span class="token plain"> │ </span><span class="token number" style="color:#36acaa">1998</span><span class="token plain"> │ MFGR</span><span class="token comment" style="color:#999988;font-style:italic">#2239 │</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─────────────────┴──────┴───────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:#36acaa">0.270</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Processed </span><span class="token number" style="color:#36acaa">6.00</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64.56</span><span class="token plain"> MB </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">22.19</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">238.76</span><span class="token plain"> MB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When testing the star schema, you may also try the cost-based optimizer by <code>set enable_optimizer=1</code> to get better performance in join queries:</p><p>Without CBO:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toYear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_ORDERDATE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> d_year</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_REVENUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> revenue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ssb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">customer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ssb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lineorder</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ssb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">supplier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_CUSTKEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> C_CUSTKEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_SUPPKEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> S_SUPPKEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C_NATION </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S_NATION </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d_year </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1992</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d_year </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1997</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d_year</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d_year </span><span class="token keyword" style="color:#00009f">ASC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    revenue </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FORMAT </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">Null</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: </span><span class="token number" style="color:#36acaa">03</span><span class="token plain">cc9993</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">26</span><span class="token plain">f3</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">46</span><span class="token plain">b9</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">93</span><span class="token plain">fc</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b108245d6d14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ok</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:#36acaa">46.525</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Processed </span><span class="token number" style="color:#36acaa">6.03</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84.22</span><span class="token plain"> MB </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">129.68</span><span class="token plain"> thousand </span><span class="token keyword" style="color:#00009f">rows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.81</span><span class="token plain"> MB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>With CBO:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toYear</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_ORDERDATE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> d_year</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_REVENUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> revenue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> ssb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">customer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ssb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lineorder</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ssb</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">supplier</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_CUSTKEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> C_CUSTKEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">LO_SUPPKEY </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> S_SUPPKEY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C_NATION </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">S_NATION </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;UNITED STATES&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d_year </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1992</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">d_year </span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1997</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    S_CITY</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d_year</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d_year </span><span class="token keyword" style="color:#00009f">ASC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    revenue </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FORMAT </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">Null</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SETTINGS enable_optimizer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: a6f92e6b</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">be44</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">c47</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b0e2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">fa58f806bdec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ok</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">rows</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:#36acaa">0.974</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_kuKB" id="clickbench">Clickbench<a href="#clickbench" class="hash-link" aria-label="Direct link to Clickbench" title="Direct link to Clickbench">​</a></h2><p><strong>Notes</strong>: clickbench dataset size is about 45GB raw data and 14 (before optimize) or 11 (after optimize) in ByConity. Make sure you have enough resource before running</p><p>The minimum requirement to run Clickbench is each container has 2CPU and 8GB RAM. If you&#x27;re using MacOS, you should config the Docker VM to have 4CPU and 8GB RAM. To have good performance, each container (except foudationdb) should has at least 4CPU and 16GB RAM.</p><p>Clickbench is a benchmark by ClickHouse, which contains 1 single flat table and the dataset of 100M rows. The dataset is obfuscated to have same data distribution as Yandex&#x27;s production data. More about the benchmark <a href="https://github.com/ClickHouse/ClickBench" target="_blank" rel="noopener noreferrer">here</a>.</p><p>To create the table and import data to it, from current directory run:</p><div class="codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-text codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token plain">./datasets/clickbench_import.sh</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The script will create the table, download the dataset, decompress it and insert into byconity via clickhouse client. When the importing done, you can test with a simple query:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: </span><span class="token number" style="color:#36acaa">08970</span><span class="token plain">ad5</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">2753</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">40</span><span class="token plain">bc</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">9</span><span class="token plain">be2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">e4bb7873f3a3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">─┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ </span><span class="token number" style="color:#36acaa">99997497</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:#36acaa">11.161</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Processed </span><span class="token number" style="color:#36acaa">100.00</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">199.99</span><span class="token plain"> MB </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">8.96</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17.92</span><span class="token plain"> MB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Notes that in the first run, data need to be pulled from hdfs, so it takes long time. In the consequence run, the local cache hit and the execution is much faster:</p><div class="language-sql codeBlockContainer_sAXX theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_pc2u"><pre tabindex="0" class="prism-code language-sql codeBlock_fjSB thin-scrollbar"><code class="codeBlockLines_FFvy"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> hits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Query id: </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">f6088a0</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">f9c6</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">c23</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">a4be</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">b1c3b1b8cb6c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">┌──</span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">─┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ </span><span class="token number" style="color:#36acaa">99997497</span><span class="token plain"> │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└──────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Elapsed: </span><span class="token number" style="color:#36acaa">1.545</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> Processed </span><span class="token number" style="color:#36acaa">100.00</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">199.99</span><span class="token plain"> MB </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">64.71</span><span class="token plain"> million </span><span class="token keyword" style="color:#00009f">rows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129.43</span><span class="token plain"> MB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_tcEP"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_Zxeh" aria-hidden="true"><svg class="copyButtonIcon_Pc49" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_Ol7y" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You can try to play with the table with the query provided in <code>datasets/clickbench.sql</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags__Zuh padding--none margin-left--sm"><li class="tag_G1J1"><a class="tag_lVyf tagRegular_MP1R" href="/docs/tags/docs">Docs</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ByConity/byconity.github.io/tree/main/docs/basic-guide/docker-playground.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_rssB" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_ZTIL"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/basic-guide/deployment-requirements"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Deployment Requirements</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/basic-guide/monitoring"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Monitor Cluster</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_a4zv thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisite" class="table-of-contents__link toc-highlight">Prerequisite</a></li><li><a href="#cluster-architecture" class="table-of-contents__link toc-highlight">Cluster architecture</a></li><li><a href="#bring-the-cluster-up" class="table-of-contents__link toc-highlight">Bring the cluster up</a></li><li><a href="#trying-some-basic-queries" class="table-of-contents__link toc-highlight">Trying some basic queries</a></li><li><a href="#a-quick-look-into-how-the-data-is-stored" class="table-of-contents__link toc-highlight">A quick look into how the data is stored</a><ul><li><a href="#metadata" class="table-of-contents__link toc-highlight">Metadata</a></li><li><a href="#remote-data" class="table-of-contents__link toc-highlight">Remote data</a></li></ul></li><li><a href="#ssb-benchmark" class="table-of-contents__link toc-highlight">SSB benchmark</a></li><li><a href="#clickbench" class="table-of-contents__link toc-highlight">Clickbench</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row"><div class="col col--3"><img src="/img/footer-logo.svg" alt="ByConity" class="themedImage_rLhL themedImage--light_CjtC footer__logo"><img src="/img/footer-logo.svg" alt="ByConity" class="themedImage_rLhL themedImage--dark_quyK footer__logo"></div><div class="col"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/main-principle-concepts">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community">Community</a></li><li class="footer__item"><a class="footer__link-item" href="/users">Users</a></li><li class="footer__item"><a href="https://space.bilibili.com/2065226922?spm_id_from=333.1007.0.0" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/ByConity/ByConity" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TSiV"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 ByteDance.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.4c8af0de.js"></script>
<script src="/assets/js/main.277df070.js"></script>
</body>
</html>